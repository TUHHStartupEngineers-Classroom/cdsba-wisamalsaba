{
  "hash": "7378b3360a20a163af506fe52d9c7db1",
  "result": {
    "markdown": "---\ntitle: \"Probability Theory\"\nauthor: \"Wisam Alsaba\"\nformat: \n    html:\n      code-line-numbers: true\n      df-print: paged\n---\n\n----\n#### **Assignment 1.1**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-1_9eeac579164e732b083506c929f1e3b4'}\n\n```{.r .cell-code}\n# Define the probabilities and complementary probabilities\n# the dash refers to the complementary probability\nP_S <- 0.3\nP_T_S <- 0.2\nP_T_S_dash <- 0.6\nP_S_dash <- 1 - P_S\nP_T_dash_S <- 1 - P_T_S\nP_T_dash_S_dash <- 1 - P_T_S_dash\n\n# Calculate the conditional probabilities\n# inter refers to intersection\nP_T_inter_S <- P_S * P_T_S\nP_T_inter_S_dash <- P_S_dash * P_T_S_dash\nP_T_dash_inter_S <- P_S * P_T_dash_S\nP_T_dash_inter_S_dash <- P_S_dash * P_T_dash_S_dash\n\n# Execute the results\nprint(P_T_inter_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.06\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_inter_S_dash)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.42\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_dash_inter_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.24\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_dash_inter_S_dash)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.28\n```\n:::\n:::\n\n#### **Assignment 1.2**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-2_0b2f5dc446057f1d85773f3db1c5cfa9'}\n\n```{.r .cell-code}\n# Load all necessary libraries\nlibrary(tidyverse)\nlibrary(ggVennDiagram)\n\n# Total Number of observations\nnum_observations <- 1000\n\n# Create tibble to simulate user device usage\nuser_devices <- tibble(\n  user_id = 1:num_observations,\n  smartphone = rbinom(num_observations, 1, 0.4),\n  tablet = ifelse(smartphone == 1, rbinom(num_observations, 1, 0.2), rbinom(num_observations, 1, 0.5)),\n  computer = ifelse(tablet == 1, rbinom(num_observations, 1, 0.1), rbinom(num_observations, 1, 0.3))\n)\n\n# Ensure at least one device is active for each user\nuser_devices <- user_devices %>%\n  rowwise() %>% \n  mutate(smartphone = ifelse(sum(smartphone, tablet, computer) == 0, 1, smartphone))\n\n# Display the first ten lines\nhead(user_devices, 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"user_id\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"smartphone\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tablet\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"computer\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"5\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"6\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\"},{\"1\":\"7\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\"},{\"1\":\"10\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Get column sums\ncolumn_sums <- colSums(user_devices)\n\n# Extract sets for each device\nusers_with_smartphone <- which(user_devices$smartphone == 1)\nusers_with_tablet <- which(user_devices$tablet == 1)\nusers_with_computer <- which(user_devices$computer == 1)\n\n# List of all device sets\ndevice_sets <- list(users_with_smartphone, users_with_tablet, users_with_computer)\n\n# Plot Venn diagram to visualize device usage overlap\nggVennDiagram(device_sets, category.names = c(\"Smartphone\", \"Tablet\", \"Computer\"),\n              label_percent_digit = 2) +\n  # Customize appearance\n  theme(legend.position = \"none\", \n        panel.background = element_rect(\"white\"),\n        strip.background = element_rect(\"white\")) +\n  scale_x_continuous(expand = expansion(mult = .24))\n```\n\n::: {.cell-output-display}\n![](01_probability_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Calculate intersection of all three device sets\nusers_with_all_devices <- Reduce(intersect, device_sets)\npercentage_all_devices <- length(users_with_all_devices) / num_observations * 100\ncat(\"Percentage of customers using all three devices:\", round(percentage_all_devices, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using all three devices: 1 %\n```\n:::\n\n```{.r .cell-code}\n# Calculate union of sets for users with at least two devices\nusers_with_at_least_two <- union(intersect(users_with_smartphone, users_with_tablet), union(intersect(users_with_smartphone, users_with_computer), \n                                       intersect(users_with_computer, users_with_tablet)))\npercentage_at_least_two_devices <- length(users_with_at_least_two) / num_observations * 100\ncat(\"Percentage of customers using at least two devices:\", round(percentage_at_least_two_devices, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using at least two devices: 22 %\n```\n:::\n\n```{.r .cell-code}\n# Calculate sets for users using only one device independently\nusers_with_only_smartphone <- users_with_smartphone[!(users_with_smartphone %in% users_with_tablet) & \n                                                      !(users_with_smartphone %in% users_with_computer)]\nusers_with_only_tablet <- users_with_tablet[!(users_with_tablet %in% users_with_smartphone) & \n                                              !(users_with_tablet %in% users_with_computer)]\nusers_with_only_computer <- users_with_computer[!(users_with_computer %in% users_with_smartphone) & \n                                                  !(users_with_computer %in% users_with_tablet)]\npercentage_only_one_device <- (length(users_with_only_smartphone) + length(users_with_only_tablet) + \n                                 length(users_with_only_computer)) / num_observations * 100\ncat(\"Percentage of customers using just one device:\", round(percentage_only_one_device, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using just one device: 78 %\n```\n:::\n:::\n\n#### **Assignment 1.3**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-3_b2545ea53982f9844a539df5c21f6e50'}\n\n```{.r .cell-code}\n#Calculating the probabilities\nProb_A <- 0.04\nProb_B_A <- 0.97\nProb_B_A_Dash <- 0.01\nProb_A_Dash <- 1- Prob_A\nProb_B_Dash_A <- 1 - Prob_B_A\nProb_B_Dash_A_Dash <- 1 - Prob_B_A_Dash\nProb_B <- (Prob_B_A*Prob_A)+(Prob_B_A_Dash*Prob_A_Dash)\nProb_A_Dash_given_B <- (Prob_B_A_Dash * Prob_A_Dash)/Prob_B\nProb_A_given_B <- (Prob_B_A * Prob_A)/Prob_B\n#print the probabilities\nprint(Prob_A_Dash_given_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.1983471\n```\n:::\n\n```{.r .cell-code}\nprint(Prob_A_given_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.8016529\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}